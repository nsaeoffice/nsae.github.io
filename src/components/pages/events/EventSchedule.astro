---
import Clock from "@tabler/icons/outline/clock.svg";
import MapPin from "@tabler/icons/outline/map-pin.svg";
import User from "@tabler/icons/outline/user.svg";
import type { CollectionEntry } from "astro:content";

interface Props {
  sessionsByDay: Record<
    string,
    CollectionEntry<"events">["data"]["eventSchedule"]
  >;
  formatTime: (date: Date) => string;
}
const { sessionsByDay, formatTime } = Astro.props;
---

{
  Object.keys(sessionsByDay).length > 0 && (
    <section>
      <h2 class="font-sans text-2xl font-medium tracking-tight mb-6">
        Schedule
      </h2>
      <div class="flex flex-col gap-8">
        {Object.entries(sessionsByDay).map(([dayLabel, sessions]) => (
          <div class="rounded-xl border bg-card text-card-foreground shadow-sm p-4">
            <h3 class="font-sans font-medium leading-none tracking-tight text-lg text-center">
              {dayLabel}
            </h3>
            <div class="pt-0 mt-4 flex flex-col gap-4">
              {sessions?.map((session) => (
                <div class="group relative grid gap-1 pb-4 last:pb-0 border-l-2 border-muted pl-4 hover:border-primary transition-colors">
                  <p class="flex flex-row items-center gap-1 font-mono text-xs uppercase tracking-wide leading-none text-muted-foreground">
                    <Clock class="size-4 shrink-0" />
                    {formatTime(session.startTime)} â€“{" "}
                    {formatTime(session.endTime)}
                  </p>
                  <p class="font-sans font-medium text-lg leading-none">
                    {session.sessionTitle}
                  </p>
                  <div class="flex flex-wrap gap-x-4 gap-y-1 font-sans text-sm text-muted-foreground mt-1">
                    {session.location && (
                      <span class="flex items-center gap-1">
                        <MapPin class="h-3.5 w-3.5" /> {session.location}
                      </span>
                    )}
                    {session.speaker && (
                      <span class="flex items-center gap-1">
                        <User class="size-4" /> {session.speaker}
                      </span>
                    )}
                  </div>
                  {session.description && (
                    <p class="font-sans text-sm text-muted-foreground mt-2">
                      {session.description}
                    </p>
                  )}
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
    </section>
  )
}
